{% extends "base.html" %}
{% block title %}Cursos{% endblock %}

{% block content %}
<div class="sec-shell">
  <h1 class="sec-title">üéì Cursos realizados</h1>

  {% if items %}
    {% for x in items %}
      <div class="card">
        <h2 class="card-title">{{ x.nombrecurso }}</h2>

        <div class="kv">
          {% if x.descripcioncurso %}<div><b>Descripci√≥n:</b> {{ x.descripcioncurso }}</div>{% endif %}
          {% if x.entidadpatrocinadora %}<div><b>Entidad patrocinadora:</b> {{ x.entidadpatrocinadora }}</div>{% endif %}
          {% if x.totalhoras %}<div><b>Horas:</b> {{ x.totalhoras }}</div>{% endif %}

          {% if x.fechainicio or x.fechafin %}
            <div><b>Fechas:</b> {{ x.fechainicio }} {% if x.fechafin %}‚Üí {{ x.fechafin }}{% endif %}</div>
          {% endif %}

          {% if x.nombrecontactoauspicia %}<div><b>Contacto:</b> {{ x.nombrecontactoauspicia }}</div>{% endif %}
          {% if x.telefonocontactoauspicia %}<div><b>Tel. contacto:</b> {{ x.telefonocontactoauspicia }}</div>{% endif %}
          {% if x.emailempresapatrocinadora %}<div><b>Email entidad:</b> {{ x.emailempresapatrocinadora }}</div>{% endif %}
        </div>

        <div class="cert-row">
          {% if x.certificado_imagen %}
            <img class="cert-mini" src="{{ x.certificado_imagen.url }}" alt="Certificado">
          {% endif %}

          <div class="cert-actions">
            {% if x.certificado_pdf %}
              <!-- Llama a la view que redirige al PDF en Cloudinary -->
              <a class="btn-outline" target="_blank" href="{% url 'ver_certificado_pdf' x.idcursorealizado %}">Abrir PDF</a>
            {% endif %}

            {% if x.rutacertificado %}
              <a class="btn-outline" target="_blank" rel="noopener" href="{{ x.rutacertificado }}">Ver certificado</a>
            {% endif %}
          </div>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p>No hay cursos registrados.</p>
  {% endif %}

  <a class="back-link" href="{% url 'home' %}">‚Üê Volver al inicio</a>
</div>
{% endblock %}
